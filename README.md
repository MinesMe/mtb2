# МТБанк — мобильное веб‑приложение (PWA) с ИИ‑анализом отчета

## Что внутри
- **Мобильный вход**: `public/mobile.html` + `public/mobile.jsx` — мобильный интерфейс «как приложение»: шапка‑заглушка, placeholder карточки, лента операций, нижняя навигация (Главная/Платежи/Продукты/Чат), мастер создания отчета в модальном окне.
- **Статические ресурсы**: `public/styles.css`, `public/manifest.webmanifest`, `public/sw.js` (PWA, офлайн/кэш).
- **Бэкенд**: `server.js` (Express) — `POST /api/analyze` принимает PDF и ответы, извлекает текст из PDF, удаляет ФИО (PII), отправляет в Gemini и возвращает красиво отформатированный Markdown.

## Быстрый старт
1. Node.js 18+
2. `.env` (см. `.env.example`):
```
GEMINI_API_KEY=ваш_ключ
GEMINI_MODEL=gemini-1.5-pro
PORT=0
```
3. Установка и запуск:
```
npm install
npm run dev
```
Сервер сам подберет свободный порт (например, `http://localhost:51xx`).

### Если изменения «не подтягиваются»
- Это может быть из‑за service worker. Сделайте «жесткое» обновление:
  - Закройте все вкладки с сайтом, откройте снова адрес и обновите 2–3 раза.
  - Или DevTools → Application → Service Workers → Unregister/Update.
  - Явно увеличен кэш SW (`mtb-mobile-v2`).

## Процесс анализа
- Во вкладке «Продукты» нажмите «Создать отчет».
- Пройдите 5 вопросов, при желании задайте имя/фамилию для корректного удаления PII.
- Загрузите PDF (до 20 МБ). Сервер очистит ФИО и отправит текст в Gemini.
- Получите структурированный, красиво оформленный Markdown‑отчет.

## Скрипты
- `npm start` — прод запуск
- `npm run dev` — дев сервер (nodemon)

## Очистка от неиспользуемых файлов
В мобильной версии не используются: `public/index.html`, `public/app.html`, `public/report.html`, `public/report.js`.
Их можно удалить для порядка.
